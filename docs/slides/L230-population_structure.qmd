---
title: "Population structure"
subtitle: "Fixation indices, admixture and more"
author:
    - "Per Unneberg"
date: "`r format(Sys.time(), '%d %B, %Y')`"
institute: NBIS
from: markdown+emoji
format:
  revealjs:
    theme:
      - white
      - ../nbis.scss
    self-contained: true
    toc: true
    toc-depth: 1
    slide-level: 3
    slide-number: true
    preview-links: true
    chalkboard: false
    footer: Selection
    logo: https://nbis.se/assets/img/logos/nbislogo-green.svg
    smaller: true
    highlight-style: gruvbox
    fig-height: 12
    fig-width: 10
    navigation-mode: vertical
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/apa.csl
execute:
  echo: true
  warning: false
  cache: true
  include: true
  autodep: true
  eval: true
  error: true
opts:
  knitr:
    code-fold: true
    tidy: true
    fig-format: svg
---

### Setup  {visibility="hidden" .unnumbered .unlisted}

```{r libs}
#| echo: false
#| eval: true
#| cache: false
library(knitr)
library(ggplot2)
library(viridis)
library(dotenv)
bw <- theme_bw(base_size=18) %+replace% theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))
theme_set(bw)
knitr::knit_hooks$set(inline = function(x) {
                      prettyNum(x, big.mark=" ")
                  })
```
```{r }
#| label: utility-functions
#| echo: false
#| eval: true
#| cache: false
```


# Population structure

::: {.notes }

On the limited applicability of the expected value of F_ST, [p. 243
@nei_MolecularEvolutionPhylogenetics_2000]:

- assumes idealized population structure, all subpopulations derived
  at same time (equal size, no demographic history)
- in practice difficult to know demographic history
- most natural populations do have unique phylogenetic structure

:::

### The independent population model

```{r, engine='tikz', fig.ext="svg"}
#| label: fst-independent-population-model
#| echo: false
#| eval: true
#| out-height: 300px
#| fig-height: 300px
\tikzset{pop/.style={circle, text width=20, align=center, draw, minimum width=10}}
\begin{tikzpicture}[x=1pt, y=1pt, node distance=150]
\node[pop] (pop0) at (0,0) {Pop. 0};
\node[pop, below of=pop0] (popC) {Pop. C};
\node[pop, left of=popC] (popB) {Pop. B};
\node[pop, left of=popB] (popA) {Pop. A};
\node[right of=popC, node distance=75] (dot1) {...};
\node[right of=dot1, node distance=75] (dot2) {...};
\node[right of=dot2, node distance=75] (dot3) {...};
\node[pop, right of=dot3, node distance=75] (popK) {Pop. K};
\draw (pop0) edge node[above] {$\theta_A$} (popA);
\draw (pop0) edge node[left] {$\theta_B$} (popB);
\draw (pop0) edge node[left] {$\theta_C$} (popC);
\draw (pop0) edge node[above] {$\theta_K$} (popK);
\draw (current bounding box.north east) -- (current bounding box.north west) -- (current bounding box.south west) -- (current bounding box.south east) -- cycle;

\end{tikzpicture}
```


### Refs {.unnumbered .unlisted}

::: { #refs }
:::
